---
title: ''
csl: peerj.csl
fontsize: 11pt
output:
  pdf_document:
    includes:
      in_header: header.tex
    keep_tex: yes
geometry: margin=1.0in
bibliography: null
---

# The Influence of Different High Fidelity DNA Polymerase on 16S rRNA Sequencing

\vspace{10mm}

\begin{center}
Marc A Sze and Patrick D Schloss

\vspace{10mm}

Supplemental
\end{center}


\newpage

```{r knitr_settings, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}

source('../code/functions.R')

loadLibs(c("tidyverse", "scales", "knitr", "rmarkdown"))

```


**Table S1: ANOVA Results of Differences in Number of OTUs between HiFi DNA Polymerases in Fecal and Mock Samples**

```{r supplemental_table1, echo=FALSE, message=FALSE, warning=FALSE}

fs_anova <- as.data.frame(read_csv("../data/process/tables/fecal_overall_anova_results.csv")) %>% 
  filter(sub_sample_level == 1000) %>% 
  select(-sub_sample_level) %>% 
  mutate_at(vars(Sum.Sq:F.value), funs(round(., digits = 2))) %>% 
  mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
  mutate(sample_type = "Fecal Sample") %>% 
  bind_rows(
    as.data.frame(read_csv("../data/process/tables/mock_overall_anova_results.csv")) %>% 
    mutate_at(vars(Sum.Sq:F.value), funs(round(., digits = 2))) %>% 
    mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
    filter(sub_sample_level == 1000) %>% 
    select(-sub_sample_level) %>% 
    mutate(sample_type = "Mock Sample"))
  
colnames(fs_anova) <- c("DF", "Sum Squares", "Mean Squares", "F value", "P-value", "BH", "Cycle", "Sample Type")

kable(fs_anova, format = "markdown", align = 'c', padding = 2)
```


\newpage


**Table S2: Tukey Post-Hoc Results of Differences in Number of OTUs between HiFi DNA Polymerases in Fecal and Mock Samples**

```{r supplemental_table2, echo=FALSE, message=FALSE, warning=FALSE}

fs_tukey <- as.data.frame(read_csv("../data/process/tables/fecal_overall_tukey_results.csv")) %>% 
  mutate_at(vars(diff:upr), funs(round(., digits = 2))) %>% 
  filter(sub_sample_level == 1000) %>% 
  select(-sub_sample_level) %>% 
  rename(padj = `p adj`) %>% 
  mutate(padj = as.numeric(padj)) %>% 
  mutate_at(vars(padj), funs(format(., digits = 2, nsmall = 2))) %>% 
  mutate(sample_type = "Fecal Sample") %>% 
  bind_rows(
    as.data.frame(read_csv("../data/process/tables/mock_overall_tukey_results.csv")) %>% 
    mutate_at(vars(diff:upr), funs(round(., digits = 2))) %>% 
    filter(sub_sample_level == 1000) %>% 
    select(-sub_sample_level) %>% 
    rename(padj = `p adj`) %>% 
    mutate(padj = as.numeric(padj)) %>% 
    filter(padj < 0.05) %>% 
    arrange(padj) %>% 
    mutate_at(vars(padj), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
    arrange(cycle) %>% 
    mutate(sample_type = "Mock Sample"))

colnames(fs_tukey) <- c("Difference", "Lower", "Upper", "P Adjusted", "Comparison", "Cycle", "Sample Type")

kable(fs_tukey, format = "markdown", align = 'c', padding = 2)

```


\newpage


**Table S3: Kruskal-Wallis Results of Differences in Error Rate, Sequences with an Error, and Chimera Prevalence between HiFi DNA Polymerases in Mock Samples**

```{r supplemental_table5, echo=FALSE, message=FALSE, warning=FALSE}

mock_error_rate_kruskal <- as.data.frame(read_csv("../data/process/tables/mock_error_overall_kruskal_results.csv")) %>% 
  mutate_at(vars(statistic), funs(round(., digits = 2))) %>% 
  mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
  select(-sub_sample_level) %>% 
  mutate(test_type = "Error Rate") %>% 
  bind_rows(
    as.data.frame(
    read_csv("../data/process/tables/mock_error_count_overall_kruskal_results.csv")) %>% 
    mutate_at(vars(statistic), funs(round(., digits = 2))) %>% 
    mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
    select(-sub_sample_level) %>% 
    mutate(test_type = "Sequences with Error")) %>% 
  bind_rows(
    as.data.frame(
    read_csv("../data/process/tables/mock_chimera_overall_kruskal_results.csv")) %>% 
    mutate_at(vars(statistic), funs(round(., digits = 2))) %>% 
    mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
    select(-sub_sample_level) %>% 
    mutate(test_type = "Chimera Prevalence"))

colnames(mock_error_rate_kruskal) <- c("Rank Sum Statistic", "DF", "P-value", "BH", "Cycle", "Test Type")

kable(mock_error_rate_kruskal, format = "markdown", align = 'c', padding = 2)
```



\newpage


**Table S4: Dunn's Post-Hoc Results of Differences in Error Rate, Sequences with an Error, and Chimera Prevalence between HiFi DNA Polymerases in Mock Samples**

```{r supplemental_table6, echo=FALSE, message=FALSE, warning=FALSE}

mock_error_rate_dunn <- as.data.frame(read_csv("../data/process/tables/mock_error_overall_dunn_results.csv")) %>% 
  mutate_at(vars(chi2:Z), funs(round(., digits = 2))) %>% 
  filter(pvalue < 0.05) %>% 
  arrange(pvalue) %>% 
  mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
  select(-bh, -sub_sample_level) %>% 
  arrange(cycle) %>% 
  mutate(test_type = "Error Rate") %>% 
  bind_rows(
    as.data.frame(read_csv("../data/process/tables/mock_error_count_overall_dunn_results.csv")) %>% 
    mutate_at(vars(chi2:Z), funs(round(., digits = 2))) %>% 
    filter(pvalue < 0.05) %>% 
    arrange(pvalue) %>% 
    mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
    select(-bh, -sub_sample_level) %>% 
    arrange(cycle) %>% 
    mutate(test_type = "Sequences with Error")) %>% 
  bind_rows(
    as.data.frame(read_csv("../data/process/tables/mock_chimera_overall_dunn_results.csv")) %>% 
    mutate_at(vars(chi2:Z), funs(round(., digits = 2))) %>% 
    filter(pvalue < 0.05) %>% 
    arrange(pvalue) %>% 
    mutate_at(vars(pvalue:bh), funs(format(., scientific = TRUE, digits = 2, nsmall = 2))) %>% 
    select(-bh, -sub_sample_level) %>% 
    arrange(cycle) %>% 
    mutate(test_type = "Chimera Prevalence"))
  

colnames(mock_error_rate_dunn) <- c("Chi Squared", "Z Statistic", "P Adjusted", "Comparison", "Cycle", "Test Type")

kable(mock_error_rate_dunn, format = "markdown", align = 'c', padding = 2)
```

\newpage









